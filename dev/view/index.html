<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <script src="../controller/utils/checkLogin.js"></script>

        <!-- <link rel="stylesheet" href="includes/style.css" /> -->
        <!-- <script src="includes/cookieScript.js"></script> -->
        <!-- <link rel="stylesheet" href="postStyle.css"> -->
        <!-- <link rel="icon" href="nfa-icon.png" type="image/x-icon" /> -->

        <script src="../controller/index/suggested.js"></script>
        <title>NoteForAll</title>
    </head>

    <body id="index-id">
        <div class="container-fluid mt-3">
            <div class="row">
                <!-- all post loaded -->
                <div class="col-lg-8 col-md-12 col-12 justify-content-center" id="posts-container">
                </div>

                <!-- suggested profile -->
                <div class="col-lg-3 d-none d-lg-block">
                    <div class="suggested-profile">
                        <h1>Suggested Profile</h1>
                        <ul class="list-unstyled" id="list-profiles">
                            <?php
                            $queryProfile = "SELECT u.*
                            FROM member u
                            WHERE u.IdUser <> {$_SESSION['userId']}
                            AND u.IdUser NOT IN (SELECT f.IdDst FROM follow f WHERE f.IdSrc = {$_SESSION['userId']})
                            ORDER BY RAND()
                            LIMIT 5;";
                            $res = $dbh->execQuery($queryProfile);
                            foreach ($res as $suggested) {
                            $querySuggestedIcon = "SELECT FilePath from media WHERE IdMedia = {$suggested['IdMedia']};";
                            $previewPathSuggestedIcon = $dbh->execQuery($querySuggestedIcon)[0]['FilePath'];
                            ?>
                            <li class="mt-3">
                                <img src="<?php echo "" . $previewPathSuggestedIcon; ?>" alt="" class="rounded rounded-circle rounded-5">
                                <a href="profile/profilePage.php?user=<?php echo ($suggested["IdUser"]); ?>">@<?php echo $suggested["Username"] ?></a>
                            </li>
                            <?php
                            }
                            ?>
                        </ul>
                    </div>
                </div>
            </div>
            <?php
            if (!isset($_COOKIE["user" . $_SESSION["userId"]])) {
            ?>
            <div class="row">
                <div id="cookie-notify" class="fixed-bottom col-12">
                    <p><strong>This site uses technical cookies to improve the user experience</strong></p>
                    <button id="ok-button">Ok</button>
                </div>
            </div>
            <?php
            }
            ?>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    </body>

</html>

